{"code":"import { ui } from \"../../../../ui/layaMaxUI\";\r\nimport Base from \"../../../../base/base\";\r\nvar Event = Laya.Event;\r\nvar Handler = Laya.Handler;\r\nexport default class CustomerService extends ui.Hall.CustomerService.CustomerServiceUI {\r\n    constructor() {\r\n        super();\r\n        this.maxWidch = 388;\r\n    }\r\n    onAwake() {\r\n        this.close_btn.on(Event.CLICK, this, () => {\r\n            Base.publicFun.hideAlert(this, () => { this.removeSelf(); });\r\n        });\r\n        this.send_btn.on(Event.CLICK, this, () => {\r\n            if (this.ask_input.text)\r\n                this.chat_list.array = [...this.chat_list.array, {\r\n                        type: 0,\r\n                        text: this.ask_input.text\r\n                    }];\r\n            this.ask_input.text = \"\";\r\n            this.chat_list.scrollTo(this.chat_list.array.length - 1);\r\n        });\r\n        this.chat_list.vScrollBarSkin = \"\";\r\n        this.chat_list.array = [{\r\n                type: 1,\r\n                text: \"您好 请问有什么可以帮助您\"\r\n            }];\r\n        this.chat_list.renderHandler = new Handler(this, this.updateItem);\r\n    }\r\n    updateItem(cell, index) {\r\n        let data = this.chat_list.array[index];\r\n        let right = cell.getChildByName(\"right\");\r\n        let left = cell.getChildByName(\"left\");\r\n        let showWho = (data.type == 0);\r\n        left.visible = !showWho;\r\n        right.visible = showWho;\r\n        let showedNode = showWho ? right : left;\r\n        let header_image = showedNode.getChildByName(\"header_image\");\r\n        let chatBox_image = showedNode.getChildByName(\"chatBox_image\");\r\n        let say_text = chatBox_image.getChildByName(\"say_text\");\r\n        say_text.text = data.text;\r\n        let rect = say_text.getBounds();\r\n        console.log(rect.width);\r\n        if (rect.width >= this.maxWidch) {\r\n            say_text.width = this.maxWidch;\r\n            say_text.wordWrap = true;\r\n            rect = say_text.getBounds();\r\n        }\r\n        else {\r\n            say_text.wordWrap = false;\r\n            say_text.width = 0;\r\n        }\r\n        chatBox_image.width = rect.width + 100;\r\n        chatBox_image.height = rect.height + 40;\r\n        cell.height = chatBox_image.height + 50;\r\n        if (showWho) {\r\n            chatBox_image.x = header_image.x - chatBox_image.width - 15;\r\n        }\r\n        say_text.pivotX = rect.width / 2;\r\n        say_text.pivotY = rect.height / 2;\r\n        say_text.x = chatBox_image.width / 2 - 15;\r\n        say_text.y = chatBox_image.height / 2;\r\n        showedNode.getChildByName(\"date_text\").text = new Date().toDateString();\r\n    }\r\n}\r\n","references":["C:/Users/Administrator/Documents/majiang/src/ui/layaMaxUI.ts","C:/Users/Administrator/Documents/majiang/src/base/base.ts"]}
