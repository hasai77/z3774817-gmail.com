{
  "code": "export default class network {\r\n    constructor() {\r\n        this.eList = new Array();\r\n        this.types = {};\r\n        this.byte = new Laya.Byte();\r\n        this.byte.endian = Laya.Byte.LITTLE_ENDIAN;\r\n        this.socket = new Laya.Socket();\r\n        this.socket.endian = Laya.Byte.LITTLE_ENDIAN;\r\n        this.connect();\r\n    }\r\n    static getinstance() {\r\n        if (this.instance == null)\r\n            this.instance = new network();\r\n        return this.instance;\r\n    }\r\n    addNetEvent(type, handler) {\r\n        this.types[type] = handler;\r\n    }\r\n    removeEvent(type) {\r\n        if (this.types[type])\r\n            delete this.types[type];\r\n    }\r\n    register(type, ui, caller) {\r\n        this.addNetEvent(type + \"init\", caller.GameEventLoadInitialization);\r\n        this.addNetEvent(type + \"enter\", caller.GameEventEnter);\r\n        this.addNetEvent(type + \"leave\", caller.GameEventLeave);\r\n    }\r\n    unregister(type) {\r\n        this.removeEvent(type + \"init\");\r\n        this.removeEvent(type + \"enter\");\r\n        this.removeEvent(type + \"leave\");\r\n    }\r\n    connect() {\r\n        this.socket.connectByUrl(\"ws://localhost:8989\");\r\n        this.socket.on(Laya.Event.OPEN, this, this.openHandler);\r\n        this.socket.on(Laya.Event.MESSAGE, this, this.receiveHandler);\r\n        this.socket.on(Laya.Event.CLOSE, this, this.closeHandler);\r\n        this.socket.on(Laya.Event.ERROR, this, this.errorHandler);\r\n    }\r\n    openHandler(event = null) {\r\n        Laya.timer.frameLoop(1, this, () => {\r\n            if (!this.types || this.eList.length == 0)\r\n                return;\r\n            while (this.eList.length) {\r\n                this.types[this.eList[0]];\r\n                this.eList.shift();\r\n            }\r\n        });\r\n    }\r\n    receiveHandler(msg = null) {\r\n        console.log(msg);\r\n        this.eList.push(msg);\r\n    }\r\n    closeHandler(e = null) {\r\n    }\r\n    errorHandler(e = null) {\r\n    }\r\n    sendMsg(type, data) {\r\n    }\r\n}\r\n",
  "references": []
}
